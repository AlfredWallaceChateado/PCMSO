<!DOCTYPE html>
<html>
<head>
  <title>Consulta de Agendamento</title>
</head>
<body>
  <h2>Consulte seu agendamento</h2>
  <label for="nome">Digite seu nome completo ou parte dele:</label><br>
  <input type="text" id="nome" size="40" />
  <button onclick="consultar()">Consultar</button>

  <div id="resultado" style="margin-top:20px;"></div>

  <script>
    function consultar() {
      var nome = document.getElementById("nome").value.trim();
      var div = document.getElementById("resultado");

      if (!nome) {
        alert("Por favor, digite o nome.");
        return;
      }
      
      // Mostra feedback de carregamento
      div.innerHTML = '<em>Carregando...</em>';
      
      var url = 'https://script.google.com/macros/s/AKfycbxd2yC5V_taHzqD9YCcjbxQS1Jf86yYCZap7xhCrJpFQRWUngx2eeqANLArLwa_5aD4/exec' + '?nome=' + encodeURIComponent(nome);
      
      fetch(url)
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            div.innerHTML = '<span style="color:red;">' + data.error + '</span>';
          } else {
            div.innerHTML =
              '<b>Nome:</b> ' + data.nome + '<br>' +
              '<b>Data de nascimento:</b> ' + (data.dataNascimento ? data.dataNascimento : 'Não disponível') + '<br>' +
              '<b>Data da consulta:</b> ' + (data.dataConsulta ? data.dataConsulta : 'Não disponível') + '<br>' +
              '<b>Horário:</b> ' + (data.horario ? data.horario : 'Não disponível') + '<br>' +
              '<b>Sala:</b> ' + (data.sala ? data.sala : 'Não disponível') + '<br>' +
              '<b>Observações:</b> ' + (data.observacoes ? data.observacoes : 'Nenhuma');
          }
        })
        .catch(error => {
          div.innerHTML = '<span style="color:red;">Erro ao consultar. Tente novamente.</span>';
          console.error('Erro:', error);
        });
    }
  </script>
</body>
</html>


