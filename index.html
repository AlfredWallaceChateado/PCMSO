<!DOCTYPE html>
<html>
<head>
  <title>[translate:Consulta de Agendamento]</title>
</head>
<body>
  <h2>[translate:Consulte seu agendamento]</h2>
  <label for="nome">[translate:Digite seu nome completo ou parte dele:]</label><br>
  <input type="text" id="nome" size="40" />
  <button onclick="consultar()">[translate:Consultar]</button>

  <div id="resultado" style="margin-top:20px;"></div>

  <script>
    function consultar() {
      var nome = document.getElementById("nome").value.trim();
      var div = document.getElementById("resultado");

      if (!nome) {
        alert("[translate:Por favor, digite o nome.]");
        return;
      }
      
      // [translate:Mostra feedback de carregamento]
      div.innerHTML = '<em>[translate:Carregando...]</em>';
      
      var url = 'https://script.google.com/macros/s/AKfycbzwON8TeQbld12L3GhgYQ4y5v5KYk7ok3unMVclP324Y06HzeSNwFxgNdjUGthP7Xoe/exec' + '?nome=' + encodeURIComponent(nome);
      
      fetch(url)
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            div.innerHTML = '<span style="color:red;">' + data.error + '</span>';
          } else {
            div.innerHTML =
              '<b>[translate:Nome]:</b> ' + data.nome + '<br>' +
              '<b>[translate:Data de nascimento]:</b> ' + (data.dataNascimento ? data.dataNascimento : '[translate:Não disponível]') + '<br>' +
              '<b>[translate:Data da consulta]:</b> ' + (data.dataConsulta ? data.dataConsulta : '[translate:Não disponível]') + '<br>' +
              '<b>[translate:Horário]:</b> ' + (data.horario ? data.horario : '[translate:Não disponível]') + '<br>' +
              '<b>[translate:Sala]:</b> ' + (data.sala ? data.sala : '[translate:Não disponível]') + '<br>' +
              '<b>[translate:Observações]:</b> ' + (data.observacoes ? data.observacoes : '[translate:Nenhuma]');
          }
        })
        .catch(error => {
          div.innerHTML = '<span style="color:red;">[translate:Erro ao consultar. Tente novamente.]</span>';
          console.error('[translate:Erro]:', error);
        });
    }
  </script>
</body>
</html>
